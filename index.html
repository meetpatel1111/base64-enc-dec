<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cyberpunk Base64 Tool</title>
<style>
    :root {
        --bg-dark: #0d0d0d;
        --glass-bg: rgba(255, 255, 255, 0.05);
        --neon: #00ffcc;
        --neon-pink: #ff00ff;
    }
    body {
        font-family: 'Segoe UI', sans-serif;
        background: var(--bg-dark);
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        animation: fadeIn 1s ease-in-out;
    }
    h1 {
        text-shadow: 0 0 15px var(--neon);
        animation: glowPulse 2s infinite alternate;
    }
    @keyframes glowPulse {
        0% { text-shadow: 0 0 10px var(--neon); }
        100% { text-shadow: 0 0 30px var(--neon-pink); }
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .glass-card {
        background: var(--glass-bg);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        padding: 20px;
        margin: 15px 0;
        width: 90%;
        max-width: 800px;
        box-shadow: 0 0 15px rgba(0, 255, 204, 0.3);
        animation: fadeIn 1s ease-in-out;
    }
    textarea {
        width: 100%;
        height: 150px;
        background: transparent;
        border: none;
        color: var(--neon);
        font-size: 16px;
        padding: 10px;
        border-radius: 8px;
        outline: none;
        resize: vertical;
    }
    button {
        margin: 5px;
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        background: var(--neon);
        color: black;
        cursor: pointer;
        border-radius: 5px;
        transition: 0.3s;
        box-shadow: 0 0 10px var(--neon);
    }
    button:hover {
        background: var(--neon-pink);
        box-shadow: 0 0 20px var(--neon-pink);
        transform: scale(1.05);
    }
    #fileDrop {
        border: 2px dashed var(--neon);
        padding: 20px;
        margin-top: 10px;
        border-radius: 8px;
        transition: 0.3s;
    }
    #fileDrop.dragover {
        background: rgba(0, 255, 204, 0.1);
        box-shadow: 0 0 20px var(--neon);
    }
    .counter {
        font-size: 14px;
        opacity: 0.7;
    }
    progress {
        width: 100%;
        height: 8px;
        border-radius: 4px;
        overflow: hidden;
    }
    progress::-webkit-progress-bar {
        background: rgba(255, 255, 255, 0.1);
    }
    progress::-webkit-progress-value {
        background: var(--neon);
    }
    img.preview {
        max-width: 100%;
        margin-top: 10px;
        border-radius: 8px;
        box-shadow: 0 0 15px var(--neon);
    }
</style>
</head>
<body>

<h1>üîê Cyberpunk Base64 Tool</h1>

<div class="glass-card">
    <textarea id="inputText" placeholder="Enter text or Base64 here..."></textarea>
    <div class="counter" id="inputCount">0 chars</div>
    <div>
        <button onclick="encodeBase64()">Encode</button>
        <button onclick="decodeBase64()">Decode</button>
        <button onclick="autoMode()">Auto</button>
        <button onclick="copyOutput()">Copy</button>
        <button onclick="downloadFile()">Download</button>
        <button onclick="generateQR()">QR Code</button>
    </div>
    <progress id="progressBar" value="0" max="100" style="display:none;"></progress>
</div>

<div class="glass-card">
    <textarea id="outputText" placeholder="Output will appear here..."></textarea>
    <div class="counter" id="outputCount">0 chars</div>
    <div id="previewContainer"></div>
</div>

<div class="glass-card" id="fileDrop" ondrop="dropHandler(event)" ondragover="dragOverHandler(event)">
    üìÇ Drag & drop a file here, or <input type="file" id="fileInput" onchange="handleFile(this)">
</div>

<div class="glass-card" id="qrContainer" style="display:none;"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
    const inputText = document.getElementById("inputText");
    const outputText = document.getElementById("outputText");
    const inputCount = document.getElementById("inputCount");
    const outputCount = document.getElementById("outputCount");
    const fileDrop = document.getElementById("fileDrop");
    const progressBar = document.getElementById("progressBar");
    const previewContainer = document.getElementById("previewContainer");

    function updateCounters() {
        inputCount.textContent = `${inputText.value.length} chars`;
        outputCount.textContent = `${outputText.value.length} chars`;
        localStorage.setItem("lastInput", inputText.value);
    }
    inputText.addEventListener("input", updateCounters);
    outputText.addEventListener("input", updateCounters);

    window.onload = () => {
        if (localStorage.getItem("lastInput")) {
            inputText.value = localStorage.getItem("lastInput");
            updateCounters();
        }
    };

    function showProgress() {
        progressBar.style.display = "block";
        progressBar.value = 0;
        let progress = 0;
        const interval = setInterval(() => {
            progress += 5;
            progressBar.value = progress;
            if (progress >= 100) clearInterval(interval);
        }, 50);
    }

    function encodeBase64() {
        try {
            showProgress();
            outputText.value = btoa(unescape(encodeURIComponent(inputText.value)));
            updateCounters();
        } catch (e) {
            alert("Error encoding text");
        }
    }

    function decodeBase64() {
        try {
            showProgress();
            let decoded = decodeURIComponent(escape(atob(inputText.value)));
            outputText.value = decoded;
            updateCounters();
            if (inputText.value.startsWith("data:image")) {
                let img = document.createElement("img");
                img.src = inputText.value;
                img.classList.add("preview");
                previewContainer.innerHTML = "";
                previewContainer.appendChild(img);
            }
        } catch (e) {
            alert("Invalid Base64 string!");
        }
    }

    function autoMode() {
        if (/^[A-Za-z0-9+/=]+$/.test(inputText.value.trim())) {
            decodeBase64();
        } else {
            encodeBase64();
        }
    }

    function copyOutput() {
        outputText.select();
        document.execCommand("copy");
        alert("Copied to clipboard!");
    }

    function handleFile(input) {
        const file = input.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = () => inputText.value = reader.result;
            reader.readAsDataURL(file);
        }
    }

    function dropHandler(ev) {
        ev.preventDefault();
        fileDrop.classList.remove("dragover");
        if (ev.dataTransfer.items) {
            for (let item of ev.dataTransfer.items) {
                if (item.kind === 'file') {
                    handleFile({ files: [item.getAsFile()] });
                }
            }
        }
    }
    function dragOverHandler(ev) {
        ev.preventDefault();
        fileDrop.classList.add("dragover");
    }

    function downloadFile() {
        try {
            const blob = new Blob([atob(outputText.value)], { type: "application/octet-stream" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "decoded_file.bin";
            a.click();
            URL.revokeObjectURL(url);
        } catch (e) {
            alert("Error creating file. Make sure output is valid Base64.");
        }
    }

    function generateQR() {
        document.getElementById("qrContainer").style.display = "block";
        document.getElementById("qrContainer").innerHTML = "";
        new QRCode(document.getElementById("qrContainer"), {
            text: outputText.value || inputText.value,
            width: 200,
            height: 200
        });
    }
</script>

</body>
</html>
