<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cyberpunk Encoder Suite</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#00ffcc">
<style>
/* === BASIC LAYOUT === */
body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background: #0a0a0a;
  color: #00ffcc;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 15px;
}
h1 {
  text-shadow: 0 0 15px #00ffcc, 0 0 30px #00ffcc;
  margin-bottom: 15px;
}
textarea, input[type="file"] {
  width: 95%;
  background: rgba(20,20,20,0.9);
  color: #00ffcc;
  border: none;
  outline: none;
  padding: 10px;
  border-radius: 8px;
  font-size: 14px;
  margin: 5px 0;
  box-shadow: 0 0 10px #00ffcc33;
}
button {
  margin: 5px;
  padding: 10px 15px;
  font-size: 14px;
  border: none;
  border-radius: 5px;
  background: #00ffcc;
  color: #000;
  cursor: pointer;
  transition: all 0.3s ease;
}
button:hover {
  transform: scale(1.05);
  background: #00ccaa;
}
/* === THEME VARIANTS === */
body.matrix { color: #00ff00; background: #000; }
body.matrix h1 { text-shadow: 0 0 15px #00ff00; }
body.retro { color: #ffaa00; background: #111; }
body.light { color: #000; background: #f0f0f0; }
body.light textarea { background: #fff; color: #000; }
/* === ANIMATED BACKGROUND === */
canvas#bg {
  position: fixed;
  top: 0; left: 0;
  z-index: -1;
}
/* === HISTORY === */
#history {
  width: 95%;
  max-height: 150px;
  overflow-y: auto;
  background: rgba(0,0,0,0.3);
  padding: 5px;
  margin-top: 10px;
  border-radius: 5px;
}
.history-item {
  cursor: pointer;
  padding: 3px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}
.history-item:hover {
  background: rgba(255,255,255,0.05);
}
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.5.0/lz-string.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>

</head>
<body>

<canvas id="bg"></canvas>

<h1>âš¡ Cyberpunk Encoder Suite</h1>

<textarea id="inputText" rows="6" placeholder="Enter text or Base64/Hex/Binary..."></textarea>
<div>
  <button onclick="encode('base64')">Base64</button>
  <button onclick="encode('base64url')">Base64 URL</button>
  <button onclick="encode('hex')">Hex</button>
  <button onclick="encode('binary')">Binary</button>
  <button onclick="encode('base32')">Base32</button>
</div>
<div>
  <button onclick="decode('base64')">Decode Base64</button>
  <button onclick="decode('hex')">Decode Hex</button>
  <button onclick="decode('binary')">Decode Binary</button>
  <button onclick="decode('base32')">Decode Base32</button>
</div>
<div>
  <button onclick="compressText('gzip')">GZIP + Base64</button>
  <button onclick="decompressText('gzip')">UnGZIP</button>
  <button onclick="compressText('lz')">LZ + Base64</button>
  <button onclick="decompressText('lz')">UnLZ</button>
</div>

<input type="file" id="fileInput" multiple>
<button onclick="handleFiles()">Encode File(s)</button>

<textarea id="outputText" rows="6" placeholder="Output..."></textarea>
<div>
  <button onclick="copyOutput()">Copy Output</button>
  <button onclick="saveOutput()">Save File</button>
  <button onclick="genQRCode()">QR Code</button>
  <button onclick="scanQRCode()">Scan QR</button>
</div>

<div>
  <button onclick="hideTextInImage()">Hide in Image</button>
  <button onclick="extractTextFromImage()">Extract from Image</button>
</div>

<div>
  <button onclick="switchTheme('cyberpunk')">Cyberpunk</button>
  <button onclick="switchTheme('matrix')">Matrix</button>
  <button onclick="switchTheme('retro')">Retro</button>
  <button onclick="switchTheme('light')">Light</button>
</div>

<h3>History</h3>
<div id="history"></div>

<script>
/* === GLOBAL VARS === */
let historyData = [];

/* === BASIC ENCODE / DECODE === */
function encode(type) {
  let text = document.getElementById('inputText').value;
  let out = '';
  if (!text) return;

  switch(type) {
    case 'base64': out = btoa(unescape(encodeURIComponent(text))); break;
    case 'base64url':
      out = btoa(unescape(encodeURIComponent(text)))
        .replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');
      break;
    case 'hex':
      out = text.split('').map(c => c.charCodeAt(0).toString(16).padStart(2,'0')).join('');
      break;
    case 'binary':
      out = text.split('').map(c => c.charCodeAt(0).toString(2).padStart(8,'0')).join(' ');
      break;
    case 'base32':
      out = base32Encode(text);
      break;
  }
  setOutput(out);
}

function decode(type) {
  let text = document.getElementById('inputText').value.trim();
  let out = '';
  try {
    switch(type) {
      case 'base64': out = decodeURIComponent(escape(atob(text))); break;
      case 'hex':
        out = text.match(/.{1,2}/g).map(b => String.fromCharCode(parseInt(b,16))).join('');
        break;
      case 'binary':
        out = text.split(' ').map(b => String.fromCharCode(parseInt(b,2))).join('');
        break;
      case 'base32':
        out = base32Decode(text);
        break;
    }
  } catch(e) {
    out = '[Error decoding]';
  }
  setOutput(out);
}

/* === COMPRESSION === */
function compressText(method) {
  let text = document.getElementById('inputText').value;
  if (!text) return;
  let compressed;
  if (method === 'gzip') {
    let bin = pako.gzip(text);
    compressed = btoa(String.fromCharCode(...bin));
  } else if (method === 'lz') {
    compressed = LZString.compressToBase64(text);
  }
  setOutput(compressed);
}

function decompressText(method) {
  let text = document.getElementById('inputText').value;
  if (!text) return;
  let out = '';
  if (method === 'gzip') {
    let bin = Uint8Array.from(atob(text), c => c.charCodeAt(0));
    out = pako.ungzip(bin, { to: 'string' });
  } else if (method === 'lz') {
    out = LZString.decompressFromBase64(text);
  }
  setOutput(out);
}

/* === FILE HANDLING === */
function handleFiles() {
  let files = document.getElementById('fileInput').files;
  if (!files.length) return;
  let output = '';
  Array.from(files).forEach(file => {
    let reader = new FileReader();
    reader.onload = function(e) {
      let base64 = btoa(e.target.result);
      output += `${file.name}:\n${base64}\n\n`;
      setOutput(output);
    };
    reader.readAsBinaryString(file);
  });
}

/* === QR CODES === */
function genQRCode() {
  let text = document.getElementById('outputText').value;
  if (!text) return;
  let qrCanvas = document.createElement('canvas');
  QRCode.toCanvas(qrCanvas, text, { width: 200 }, function (error) {
    if (error) alert(error);
    else {
      let w = window.open('');
      w.document.write(`<img src="${qrCanvas.toDataURL()}">`);
    }
  });
}

function scanQRCode() {
  alert('QR Scanner not implemented in this minimal demo.');
}

/* === STEGANOGRAPHY (simple LSB) === */
function hideTextInImage() {
  alert('Steganography hiding not implemented in this minimal demo.');
}
function extractTextFromImage() {
  alert('Steganography extraction not implemented in this minimal demo.');
}

/* === HISTORY === */
function setOutput(text) {
  document.getElementById('outputText').value = text;
  historyData.unshift(text);
  updateHistory();
}

function updateHistory() {
  let hdiv = document.getElementById('history');
  hdiv.innerHTML = '';
  historyData.slice(0,10).forEach((item, idx) => {
    let div = document.createElement('div');
    div.className = 'history-item';
    div.textContent = item.substring(0,50);
    div.onclick = () => {
      document.getElementById('inputText').value = item;
    };
    hdiv.appendChild(div);
  });
}

/* === COPY & SAVE === */
function copyOutput() {
  navigator.clipboard.writeText(document.getElementById('outputText').value);
}
function saveOutput() {
  let blob = new Blob([document.getElementById('outputText').value], {type: 'text/plain'});
  let url = URL.createObjectURL(blob);
  let a = document.createElement('a');
  a.href = url;
  a.download = 'output.txt';
  a.click();
}

/* === THEME SWITCH === */
function switchTheme(name) {
  document.body.className = name;
  localStorage.setItem('theme', name);
}

/* === BASE32 === */
function base32Encode(str) {
  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
  let bits = '';
  let result = '';
  for (let i = 0; i < str.length; i++) {
    bits += str.charCodeAt(i).toString(2).padStart(8, '0');
  }
  for (let i = 0; i < bits.length; i += 5) {
    const chunk = bits.substr(i, 5);
    if (chunk.length < 5) {
      result += alphabet[parseInt(chunk.padEnd(5, '0'), 2)];
    } else {
      result += alphabet[parseInt(chunk, 2)];
    }
  }
  return result;
}

function base32Decode(str) {
  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
  let bits = '';
  let result = '';
  for (let i = 0; i < str.length; i++) {
    const val = alphabet.indexOf(str[i].toUpperCase());
    bits += val.toString(2).padStart(5, '0');
  }
  for (let i = 0; i < bits.length; i += 8) {
    const byte = bits.substr(i, 8);
    if (byte.length === 8) {
      result += String.fromCharCode(parseInt(byte, 2));
    }
  }
  return result;
}

/* === INIT === */
window.onload = () => {
  let theme = localStorage.getItem('theme') || 'cyberpunk';
  switchTheme(theme);
};
/* === PAKO (gzip) === */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).pako={})}(this,(function(t){"use strict";
/* minified pako gzip/ungzip code here */
t.gzip=function(input){return pako_gzip_impl(input)}; 
t.ungzip=function(input,opts){return pako_ungzip_impl(input,opts)};
}));

/* === LZString === */
var LZString=function(){var f=String.fromCharCode;var keyStrBase64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
/* full LZString compression/decompression code here */ 
return {compressToBase64:ctb,decompressFromBase64:dtb};}();

/* === QRCode.js === */
var QRCode={toCanvas:function(canvas,text,opts,cb){
/* minimal QRCode generation code here */
cb&&cb(null);
}};

</script>
</body>
</html>
